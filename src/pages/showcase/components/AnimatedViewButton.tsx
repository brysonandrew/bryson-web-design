import type { FC } from "react";
import type {
  MotionProps,
  SVGMotionProps,
  Transition,
} from "framer-motion";
import { motion } from "framer-motion";
const BORDER_PATH =
  "M 17.5 0 L 134.5 0 C 143.25 0 152 8.75 152 17.5 L 152 17.5 C 152 26.25 143.25 35 134.5 35 L 134.5 35 L 17.5 35 C 8.75 35 0 26.25 0 17.5 L 0 17.5 C 0 8.75 8.75 0 17.5 0 z";
const EYE_PATH =
  "M 28.216 11.328 A 7.5898 7.5898 90 0 1 30.4 11 c 0.7249 0 1.4532 0.1079 2.184 0.3234 c 0.7316 0.2155 1.3986 0.4985 2.0021 0.8484 a 11.7579 11.7579 90 0 1 1.701 1.1999 c 0.5317 0.4502 0.9786 0.908 1.3411 1.3734 c 0.3625 0.4658 0.6485 0.9219 0.8576 1.3692 C 38.6954 16.5608 38.8 16.956 38.8 17.3 c 0 0.3436 -0.105 0.7392 -0.3142 1.1861 c -0.2092 0.4469 -0.4956 0.903 -0.8576 1.3688 c -0.3625 0.4654 -0.8093 0.9232 -1.3406 1.3734 a 11.7579 11.7579 90 0 1 -1.7014 1.1999 c -0.6031 0.3499 -1.2705 0.6329 -2.0017 0.8484 c -0.7312 0.2155 -1.4595 0.3234 -2.1844 0.3234 c -0.7249 0 -1.4532 -0.1079 -2.184 -0.3234 c -0.7316 -0.2155 -1.3986 -0.4985 -2.0021 -0.8484 a 11.7579 11.7579 90 0 1 -1.701 -1.1999 c -0.5317 -0.4502 -0.9786 -0.908 -1.3411 -1.3734 c -0.3625 -0.4658 -0.6485 -0.9219 -0.8576 -1.3692 C 22.1046 18.0392 22 17.644 22 17.3 c 0 -0.3436 0.105 -0.7392 0.3142 -1.1861 c 0.2092 -0.4469 0.4956 -0.903 0.8576 -1.3688 c 0.3625 -0.4654 0.8093 -0.9232 1.3406 -1.3734 a 11.7579 11.7579 90 0 1 1.7014 -1.1999 C 26.8174 11.8219 27.4844 11.5405 28.216 11.328 z m 0.3276 10.4908 a 6.3714 6.3714 90 0 0 1.8564 0.2814 c 0.6187 0 1.2373 -0.0953 1.8564 -0.286 c 0.6187 -0.1907 1.1735 -0.4376 1.664 -0.7409 a 11.1061 11.1061 90 0 0 1.3826 -1.008 c 0.4313 -0.3683 0.7909 -0.7308 1.0781 -1.087 c 0.2877 -0.3566 0.5124 -0.6829 0.6749 -0.9799 c 0.1625 -0.2969 0.2436 -0.5296 0.2436 -0.6985 c 0 -0.1688 -0.0811 -0.4015 -0.2436 -0.6985 c -0.1625 -0.2969 -0.3872 -0.6233 -0.6749 -0.9799 c -0.2873 -0.3562 -0.6468 -0.7182 -1.0781 -1.0874 a 11.1061 11.1061 90 0 0 -1.3826 -1.008 c -0.4906 -0.3028 -1.0458 -0.5498 -1.664 -0.7405 a 6.2752 6.2752 90 0 0 -1.8564 -0.2856 c -0.6187 0 -1.2373 0.0949 -1.8564 0.2856 c -0.6187 0.1907 -1.1735 0.4376 -1.664 0.7409 a 11.1061 11.1061 90 0 0 -1.3826 1.008 c -0.4313 0.3683 -0.7909 0.7308 -1.0781 1.087 c -0.2877 0.3566 -0.5124 0.6829 -0.6749 0.9799 c -0.1625 0.2969 -0.2436 0.5296 -0.2436 0.6985 c 0 0.1688 0.0811 0.4015 0.2436 0.6985 c 0.1625 0.2969 0.3872 0.6233 0.6749 0.9799 c 0.2873 0.3562 0.6468 0.7182 1.0781 1.0874 a 11.1061 11.1061 90 0 0 1.3826 1.008 c 0.4906 0.3028 1.0458 0.5515 1.664 0.7451 z m 3.7313 -5.4562 l 1.3406 -0.6749 c 0.2562 0.5124 0.3843 1.05 0.3843 1.6124 c 0 0.9937 -0.3515 1.8421 -1.0542 2.5452 c -0.7035 0.7031 -1.5519 1.0546 -2.5456 1.0546 s -1.8421 -0.3515 -2.5452 -1.0542 c -0.7031 -0.7035 -1.0546 -1.5519 -1.0546 -2.5456 s 0.3515 -1.8421 1.0542 -2.5452 C 28.5583 14.0517 29.4067 13.7002 30.4 13.7002 V 15.2 c -0.575 0 -1.0689 0.2062 -1.4813 0.6187 C 28.5062 16.2311 28.3 16.725 28.3 17.3 c 0 0.575 0.2062 1.0689 0.6187 1.4813 C 29.3311 19.1938 29.825 19.4 30.4 19.4 c 0.575 0 1.0689 -0.2062 1.4813 -0.6187 C 32.2938 18.3689 32.5 17.875 32.5 17.3 a 2.0706 2.0706 90 0 0 -0.2251 -0.9374 z";

const SMOOTH_EASE: [number, number, number, number] =
  [0.43, 0.13, 0.23, 0.96];
const PREV_ARROW_PATH =
  "M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z";
const NEXT_ARROW_PATH =
  "M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z";
const REVEAL_PATH =
  "M14.8.781A18.071 18.071 0 0 1 20 0c1.726 0 3.46.257 5.2.77 1.742.513 3.33 1.187 4.767 2.02a27.995 27.995 0 0 1 4.05 2.857c1.266 1.072 2.33 2.162 3.193 3.27.863 1.109 1.544 2.195 2.042 3.26C39.751 13.24 40 14.181 40 15c0 .818-.25 1.76-.748 2.824-.498 1.064-1.18 2.15-2.042 3.259-.863 1.108-1.927 2.198-3.192 3.27a27.995 27.995 0 0 1-4.051 2.857c-1.436.833-3.025 1.507-4.766 2.02-1.741.513-3.475.77-5.201.77-1.726 0-3.46-.257-5.2-.77-1.742-.513-3.33-1.187-4.767-2.02a27.995 27.995 0 0 1-4.05-2.857c-1.266-1.072-2.33-2.162-3.193-3.27-.863-1.109-1.544-2.195-2.042-3.26C.249 16.76 0 15.819 0 15c0-.818.25-1.76.748-2.824.498-1.064 1.18-2.15 2.042-3.259.863-1.108 1.927-2.198 3.192-3.27a27.995 27.995 0 0 1 4.051-2.857C11.47 1.957 13.058 1.287 14.8.781zm.78 24.978a15.17 15.17 0 0 0 4.42.67c1.473 0 2.946-.227 4.42-.681 1.473-.454 2.794-1.042 3.962-1.764a26.443 26.443 0 0 0 3.292-2.4c1.027-.877 1.883-1.74 2.567-2.588.685-.849 1.22-1.626 1.607-2.333.387-.707.58-1.261.58-1.663 0-.402-.193-.956-.58-1.663-.387-.707-.922-1.484-1.607-2.333-.684-.848-1.54-1.71-2.567-2.589a26.443 26.443 0 0 0-3.292-2.4c-1.168-.721-2.49-1.309-3.962-1.763a14.941 14.941 0 0 0-4.42-.68c-1.473 0-2.946.226-4.42.68-1.473.454-2.794 1.042-3.962 1.764a26.443 26.443 0 0 0-3.292 2.4c-1.027.877-1.883 1.74-2.567 2.588-.685.849-1.22 1.626-1.607 2.333-.387.707-.58 1.261-.58 1.663 0 .402.193.956.58 1.663.387.707.922 1.484 1.607 2.333.684.848 1.54 1.71 2.567 2.589a26.443 26.443 0 0 0 3.292 2.4c1.168.721 2.49 1.313 3.962 1.774zm8.884-12.991 3.192-1.607c.61 1.22.915 2.5.915 3.839 0 2.366-.837 4.386-2.51 6.06-1.675 1.674-3.695 2.511-6.061 2.511s-4.386-.837-6.06-2.51c-1.674-1.675-2.511-3.695-2.511-6.061s.837-4.386 2.51-6.06C15.615 7.266 17.635 6.429 20 6.429V10c-1.369 0-2.545.491-3.527 1.473C15.491 12.455 15 13.631 15 15c0 1.369.491 2.545 1.473 3.527C17.455 19.509 18.631 20 20 20c1.369 0 2.545-.491 3.527-1.473C24.509 17.545 25 16.369 25 15a4.93 4.93 0 0 0-.536-2.232z";
const ICON_SIZE = 48;

const SMOOTH: Transition = {
  type: "tween",
  ease: SMOOTH_EASE,
};

const BORDER_BASE_PROPS: SVGMotionProps<SVGPathElement> = {
  style: {
    originX: "76px",
    originY: "17.5px",
    scaleX: 1.045,
    scaleY: 1.2,
  },
  strokeDasharray: "20.61 117 20.61 13.74",
  strokeLinecap: "round",
  d: BORDER_PATH,
  transition: SMOOTH,
};

type TProps = {
  children: string;
  isActivated?: boolean;
} & MotionProps;
export const AnimatedViewButton: FC<TProps> = ({
  isActivated,
  children,
  ...rest
}) => (
  <motion.svg
    initial="initial"
    whileHover="hover"
    whileTap="tap"
    animate="animate"
    width="164"
    height="47"
    viewBox="-6 -5 164 44.5"
    fill="none"
    {...rest}
  >
    <motion.path
      variants={{
        initial: {
          strokeDashoffset: 20.61,
        },
        hover: {
          strokeDashoffset: 158.22,
        },
        tap: {
          strokeDashoffset: 158.22 * 10,
        },
      }}
      stroke="#9E9E9E"
      {...BORDER_BASE_PROPS}
    />
    <motion.path
      variants={{
        initial: {
          strokeDashoffset: 20.61,
        },
        hover: {
          strokeDashoffset: 58.5,
        },
        tap: {
          strokeDashoffset: 58.5 * 10,
        },
      }}
      stroke="#2b2b2b"
      {...BORDER_BASE_PROPS}
    />
    <motion.path d={BORDER_PATH} fill="#2b2b2b" />
    <path
      transform={
        isActivated ? "translate(122 6)" : "translate(0 0)"
      }
      d={isActivated ? NEXT_ARROW_PATH : EYE_PATH}
      fill="currentColor"
    />
    <text
      x={isActivated ? 14 : 47}
      y="23"
      fill="currentColor"
    >
      {children}
    </text>
  </motion.svg>
);
